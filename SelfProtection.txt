Option Explicit

Script("Name") = "Self Protection"
Script("Author") = "PyroManiac"


Sub Event_ServerInfo(Message)
	Dim op, mem, rank, sham
	
	If Match(Message, Config.BotOwner & " was banned by *", True) Then
		AddQ "/unban " & Config.BotOwner
		op = Split(Message, " ")(4)
	ElseIf Match(Message, Config.BotOwner & " was kicked out of the channel by *", True) Then
		op = Split(Message, " ")(8)
	End If

	DoDemote Clan.GetMemberIndex(op)
End Sub

Sub DoDemote(MemberIndex)
	Dim mem
    If MemberIndex > 0 Then
		Set mem = Clan.GetMember(MemberIndex)
		Select Case mem.Rank
			Case 3
				mem.Demote 2
			Case 2
				mem.Demote 1
				mem.Promote 2
			Case 1
				mem.Promote 2
				mem.Demote 1
			Case 0, 4
				AddChat vbRed, "[SP] Member cannot be demoted. He/she is either an initiate or the chieftain. (" & mem.Name & ")"
			Case Else
				AddChat vbRed, "[SP] Invalid member rank: " & mem.Rank & " (" & mem.Name & ")"
		End Select
		Set mem = Nothing
	End If			
End Sub